import{r as l,B as k,D as e,R as v,E as d,F as x,J as C}from"./index-Dh7Embt7.js";import{L as u}from"./list-DGbcJCbp.js";import{C as E}from"./chevron-right-BDgNP7vN.js";function $(){const[m,j]=l.useState([]),[p,N]=l.useState(""),[w,T]=l.useState(!0),[f,o]=l.useState(!1),{language:i}=k(),n=C;l.useEffect(()=>{const t=document.querySelector("article")||document.querySelector("main");if(!t)return;const s=t.querySelectorAll("h2, h3"),r=Array.from(s).map(a=>{if(!a.id){const c=a.textContent?.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"")||"";a.id=c}return{id:a.id,text:a.textContent||"",level:parseInt(a.tagName.substring(1))}});j(r);const g={rootMargin:"-280px 0px -66%",threshold:0},b=a=>{a.forEach(c=>{c.isIntersecting&&N(c.target.id)})},y=new IntersectionObserver(b,g);return s.forEach(a=>{y.observe(a)}),()=>{s.forEach(a=>{y.unobserve(a)})}},[]);const h=t=>{const s=document.getElementById(t);if(s){const b=s.getBoundingClientRect().top+window.pageYOffset-280;window.scrollTo({top:b,behavior:"smooth"})}};return m.length===0?null:e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>o(!f),className:"xl:hidden fixed bottom-6 right-6 z-50 w-12 h-12 bg-blue-900/90 backdrop-blur-sm border border-blue-800 rounded-full flex items-center justify-center shadow-lg hover:bg-blue-900 transition-colors","aria-label":"Toggle table of contents",children:e.jsx(u,{className:"text-blue-300",size:20})}),e.jsx(v,{children:f&&e.jsxs(e.Fragment,{children:[e.jsx(d.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>o(!1),className:"xl:hidden fixed inset-0 bg-black/50 backdrop-blur-sm z-40"}),e.jsxs(d.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",damping:30,stiffness:300},className:"xl:hidden fixed top-0 right-0 bottom-0 w-80 bg-gray-900 border-l border-gray-800 z-50 overflow-y-auto scrollbar-thin p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{className:"text-gray-400",size:16}),e.jsx("span",{className:"text-gray-400 text-sm",children:x(n.toc.onThisPage,i)})]}),e.jsx("button",{onClick:()=>o(!1),className:"text-gray-400 hover:text-gray-300",children:e.jsx(E,{size:20})})]}),e.jsx("ul",{className:"space-y-2",children:m.map(t=>{const s=p===t.id,r=t.level===3;return e.jsx("li",{children:e.jsx("button",{onClick:()=>{h(t.id),o(!1)},className:`
                          w-full text-left text-sm transition-all duration-200
                          ${r?"pl-4":"pl-0"}
                          ${s?"text-blue-400 font-medium":"text-gray-400 hover:text-gray-300"}
                        `,children:e.jsxs("div",{className:"flex items-center gap-2",children:[s&&e.jsx("div",{className:"w-0.5 h-4 bg-blue-400 rounded-full absolute left-6"}),e.jsx("span",{className:`line-clamp-2 ${s?"ml-3":""}`,children:t.text})]})})},t.id)})}),e.jsxs("button",{onClick:()=>{window.scrollTo({top:0,behavior:"smooth"}),o(!1)},className:"w-full mt-6 pt-4 border-t border-gray-800 text-gray-400 hover:text-gray-300 text-sm transition-colors",children:["↑ ",x(n.toc.backToTop,i)]})]})]})}),e.jsx("div",{className:"hidden xl:block fixed top-[280px] right-8 w-64 z-30",children:e.jsx(v,{children:w&&e.jsxs(d.nav,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{duration:.3},className:"bg-gray-900/50 backdrop-blur-sm border border-gray-800 rounded-lg p-4 max-h-[calc(100vh-320px)] overflow-y-auto scrollbar-thin",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4 pb-3 border-b border-gray-800",children:[e.jsx(u,{className:"text-gray-400",size:16}),e.jsx("span",{className:"text-gray-400 text-sm",children:x(n.toc.onThisPage,i)})]}),e.jsx("ul",{className:"space-y-2",children:m.map(t=>{const s=p===t.id,r=t.level===3;return e.jsx("li",{children:e.jsx("button",{onClick:()=>h(t.id),className:`
                          w-full text-left text-sm transition-all duration-200
                          ${r?"pl-4":"pl-0"}
                          ${s?"text-blue-400 font-medium":"text-gray-400 hover:text-gray-300"}
                        `,children:e.jsxs("div",{className:"flex items-center gap-2",children:[s&&e.jsx(d.div,{layoutId:"activeIndicator",className:"w-0.5 h-4 bg-blue-400 rounded-full absolute left-4",initial:!1,transition:{type:"spring",stiffness:500,damping:30}}),e.jsx("span",{className:`line-clamp-2 ${s?"ml-3":""}`,children:t.text})]})})},t.id)})}),e.jsxs("button",{onClick:()=>window.scrollTo({top:0,behavior:"smooth"}),className:"w-full mt-4 pt-4 border-t border-gray-800 text-gray-400 hover:text-gray-300 text-sm transition-colors",children:["↑ ",x(n.toc.backToTop,i)]})]})})})]})}export{$ as T};
